name: Deploy application container (arm64v8)

on:
  workflow_dispatch:
    
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: üèóÔ∏è Build application image (arm64v8)
        uses: pguyot/arm-runner-action@v2
        with:
          image_additional_mb: 4096
          base_image: raspios_lite_arm64:latest
          optimize_image: yes
          commands: |
              DOCKER_BUILDKIT=1 docker build . --file ./deploy/Dockerfile.arm --tag zsdima/web-app-update:latest
              echo "${{ secrets.DOCKER_HUB_PASSWORD }}" | docker login -u ${{ secrets.DOCKER_HUB_LOGIN }} --password-stdin
              docker push zsdima/web-app-update:latest